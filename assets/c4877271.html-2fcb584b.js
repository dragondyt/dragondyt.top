import{_ as t,o as d,c as r,e as a}from"./app-5de3c553.js";const e={},n=a('<h2 id="安卓实验–内容提供器" tabindex="-1"><a class="header-anchor" href="#安卓实验–内容提供器" aria-hidden="true">#</a> 安卓实验–内容提供器</h2><h3 id="日常踩雷" tabindex="-1"><a class="header-anchor" href="#日常踩雷" aria-hidden="true">#</a> 日常踩雷</h3><pre><code>新建了一个空activity项目\n</code></pre><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><div class="code-container"><table><tr><td data-num="1"></td><td><pre>ERROR: Failed to resolve: androidx.appcompat:appcompat:1.1.0</pre></td></tr><tr><td data-num="2"></td><td><pre>ERROR: Failed to resolve: androidx.test.ext:junit:1.1.1</pre></td></tr><tr><td data-num="3"></td><td><pre>ERROR: Failed to resolve: androidx.test.espresso:espresso-core:3.2.0</pre></td></tr><tr><td data-num="4"></td><td><pre>ERROR: Failed to resolve: androidx.constraintlayout:constraintlayout:1.1.3</pre></td></tr></table><div class="operation"><span class="breakline-btn"><i class="ic i-align-left"></i></span><span class="copy-btn"><i class="ic i-clipboard"></i></span><span class="fullscreen-btn"><i class="ic i-expand"></i></span></div></div></figure><p><img src="https://i.loli.net/2020/05/10/BSgdvitcaTNJA3C.png" alt="init.gradle"></p><p>感觉有毒，成功了，依赖还是未解决，清除缓存重启无效！<br><img src="https://i.loli.net/2020/05/10/tSw1UImsTEH6aqR.png" alt="有毒"></p><p>删除init.gradle后,成功解决，好吧，估计问题在镜像仓库，也可能是这个配置问题，以后还是老老实实用官方源吧，虽然费时间。但出错率低。<br> 　　这是我的init.gradle，路径为C:\\Users\\{username}\\.gradle，建立这个文件的目的是加速依赖下载，现在看来反而是累赘，以前用着正常，现在不能用了也不知道是什么原因。</p><figure class="highlight groovy"><figcaption data-lang="groovy"></figcaption><div class="code-container"><table><tr><td data-num="1"></td><td><pre>allprojects{</pre></td></tr><tr><td data-num="2"></td><td><pre>    repositories {</pre></td></tr><tr><td data-num="3"></td><td><pre>        def ALIYUN_REPOSITORY_URL = &#39;http://maven.aliyun.com/nexus/content/groups/public&#39;</pre></td></tr><tr><td data-num="4"></td><td><pre>        def ALIYUN_JCENTER_URL = &#39;http://maven.aliyun.com/nexus/content/repositories/jcenter&#39;</pre></td></tr><tr><td data-num="5"></td><td><pre>        def ALIYUN_GOOGLE_URL = &#39;https://maven.aliyun.com/repository/google/&#39;</pre></td></tr><tr><td data-num="6"></td><td><pre>        def ALIYUN_GRADLE_PLUGIN_URL = &#39;https://maven.aliyun.com/repository/gradle-plugin/&#39;</pre></td></tr><tr><td data-num="7"></td><td><pre>        all { ArtifactRepository repo -&gt;</pre></td></tr><tr><td data-num="8"></td><td><pre>            if(repo instanceof MavenArtifactRepository){</pre></td></tr><tr><td data-num="9"></td><td><pre>                def url = repo.url.toString()</pre></td></tr><tr><td data-num="10"></td><td><pre>                if (url.startsWith(&#39;https://repo1.maven.org/maven2&#39;)) {</pre></td></tr><tr><td data-num="11"></td><td><pre>                    project.logger.lifecycle &quot;Repository ${repo.url} replaced by $ALIYUN_REPOSITORY_URL.&quot;</pre></td></tr><tr><td data-num="12"></td><td><pre>                    remove repo</pre></td></tr><tr><td data-num="13"></td><td><pre>                }</pre></td></tr><tr><td data-num="14"></td><td><pre>                if (url.startsWith(&#39;https://jcenter.bintray.com/&#39;)) {</pre></td></tr><tr><td data-num="15"></td><td><pre>                    project.logger.lifecycle &quot;Repository ${repo.url} replaced by $ALIYUN_JCENTER_URL.&quot;</pre></td></tr><tr><td data-num="16"></td><td><pre>                    remove repo</pre></td></tr><tr><td data-num="17"></td><td><pre>                }</pre></td></tr><tr><td data-num="18"></td><td><pre>if (url.startsWith(&#39;https://dl.google.com/dl/android/maven2/&#39;)) {</pre></td></tr><tr><td data-num="19"></td><td><pre>                    project.logger.lifecycle &quot;Repository ${repo.url} replaced by $ALIYUN_GOOGLE_URL.&quot;</pre></td></tr><tr><td data-num="20"></td><td><pre>                    remove repo</pre></td></tr><tr><td data-num="21"></td><td><pre>                }</pre></td></tr><tr><td data-num="22"></td><td><pre>                if (url.startsWith(&#39;https://plugins.gradle.org/m2/&#39;)) {</pre></td></tr><tr><td data-num="23"></td><td><pre>                    project.logger.lifecycle &quot;Repository ${repo.url} replaced by $ALIYUN_GRADLE_PLUGIN_URL.&quot;</pre></td></tr><tr><td data-num="24"></td><td><pre>                    remove repo</pre></td></tr><tr><td data-num="25"></td><td><pre>                }</pre></td></tr><tr><td data-num="26"></td><td><pre>            }</pre></td></tr><tr><td data-num="27"></td><td><pre>        }</pre></td></tr><tr><td data-num="28"></td><td><pre>        maven {</pre></td></tr><tr><td data-num="29"></td><td><pre>                url ALIYUN_REPOSITORY_URL</pre></td></tr><tr><td data-num="30"></td><td><pre>                url ALIYUN_JCENTER_URL</pre></td></tr><tr><td data-num="31"></td><td><pre>	url ALIYUN_GOOGLE_URL </pre></td></tr><tr><td data-num="32"></td><td><pre> 	url ALIYUN_GRADLE_PLUGIN_URL </pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>        }</pre></td></tr><tr><td data-num="35"></td><td><pre>    }</pre></td></tr><tr><td data-num="36"></td><td><pre>}</pre></td></tr></table><div class="operation"><span class="breakline-btn"><i class="ic i-align-left"></i></span><span class="copy-btn"><i class="ic i-clipboard"></i></span><span class="fullscreen-btn"><i class="ic i-expand"></i></span></div></div></figure><p><img src="https://i.loli.net/2020/05/10/6Az2DZ4cuX35WGR.png" alt="image.png"></p><h3 id="问题解决了-开工干活" tabindex="-1"><a class="header-anchor" href="#问题解决了-开工干活" aria-hidden="true">#</a> 问题解决了，开工干活</h3><h4 id="实验目的" tabindex="-1"><a class="header-anchor" href="#实验目的" aria-hidden="true">#</a> 实验目的</h4><p>1、掌握运行时权限使用<br> 2、掌握访问其他应用程序的数据</p><h4 id="实验内容" tabindex="-1"><a class="header-anchor" href="#实验内容" aria-hidden="true">#</a> 实验内容</h4><p>1．实现拨打电话功能<br> 2．访问通讯录</p><h4 id="实验仪器" tabindex="-1"><a class="header-anchor" href="#实验仪器" aria-hidden="true">#</a> 实验仪器</h4><p>1)PC机最低配置：2G Hz以上双核CPU,2G以上内存<br> 2)Windows 32位或64位操作系统<br> 3)Android Studio 2.2及以上版本</p><h4 id="实验主要步骤" tabindex="-1"><a class="header-anchor" href="#实验主要步骤" aria-hidden="true">#</a> 实验主要步骤</h4><p>1）创建实验项目：选择Empty Activity<br> 2）编写布局文件；</p><p>activity_main.xml</p><figure class="highlight xml"><figcaption data-lang="xml"></figcaption><div class="code-container"><table><tr><td data-num="1"></td><td><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</pre></td></tr><tr><td data-num="2"></td><td><pre>&lt;androidx.constraintlayout.widget.ConstraintLayout</pre></td></tr><tr><td data-num="3"></td><td><pre>        xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</pre></td></tr><tr><td data-num="4"></td><td><pre>        xmlns:tools=&quot;http://schemas.android.com/tools&quot;</pre></td></tr><tr><td data-num="5"></td><td><pre>        xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</pre></td></tr><tr><td data-num="6"></td><td><pre>        android:layout_width=&quot;match_parent&quot;</pre></td></tr><tr><td data-num="7"></td><td><pre>        android:layout_height=&quot;match_parent&quot;</pre></td></tr><tr><td data-num="8"></td><td><pre>        tools:context=&quot;.MainActivity&quot;&gt;</pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    &lt;ListView</pre></td></tr><tr><td data-num="11"></td><td><pre>            android:id=&quot;@+id/list&quot;</pre></td></tr><tr><td data-num="12"></td><td><pre>            android:layout_width=&quot;match_parent&quot;</pre></td></tr><tr><td data-num="13"></td><td><pre>            android:layout_height=&quot;match_parent&quot;</pre></td></tr><tr><td data-num="14"></td><td><pre>            app:layout_constraintBottom_toBottomOf=&quot;parent&quot;</pre></td></tr><tr><td data-num="15"></td><td><pre>            app:layout_constraintLeft_toLeftOf=&quot;parent&quot;</pre></td></tr><tr><td data-num="16"></td><td><pre>            app:layout_constraintRight_toRightOf=&quot;parent&quot;</pre></td></tr><tr><td data-num="17"></td><td><pre>            app:layout_constraintTop_toTopOf=&quot;parent&quot;/&gt;</pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</pre></td></tr></table><div class="operation"><span class="breakline-btn"><i class="ic i-align-left"></i></span><span class="copy-btn"><i class="ic i-clipboard"></i></span><span class="fullscreen-btn"><i class="ic i-expand"></i></span></div></div></figure><p>list_item.xml</p><figure class="highlight xml"><figcaption data-lang="xml"></figcaption><div class="code-container"><table><tr><td data-num="1"></td><td><pre>&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</pre></td></tr><tr><td data-num="2"></td><td><pre>              xmlns:tools=&quot;http://schemas.android.com/tools&quot; android:orientation=&quot;horizontal&quot;</pre></td></tr><tr><td data-num="3"></td><td><pre>              android:layout_width=&quot;match_parent&quot;</pre></td></tr><tr><td data-num="4"></td><td><pre>              android:layout_height=&quot;wrap_content&quot;</pre></td></tr><tr><td data-num="5"></td><td><pre>              android:layout_margin=&quot;20dp&quot;</pre></td></tr><tr><td data-num="6"></td><td><pre>              android:padding=&quot;5dp&quot;&gt;</pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>    &lt;ImageView</pre></td></tr><tr><td data-num="9"></td><td><pre>            android:contentDescription=&quot;@string/icon&quot;</pre></td></tr><tr><td data-num="10"></td><td><pre>            android:src=&quot;@mipmap/kyzja1gl2m4&quot;</pre></td></tr><tr><td data-num="11"></td><td><pre>            android:id=&quot;@+id/image_photo&quot;</pre></td></tr><tr><td data-num="12"></td><td><pre>            android:layout_width=&quot;70dp&quot;</pre></td></tr><tr><td data-num="13"></td><td><pre>            android:layout_height=&quot;70dp&quot; /&gt;</pre></td></tr><tr><td data-num="14"></td><td><pre>    &lt;LinearLayout</pre></td></tr><tr><td data-num="15"></td><td><pre>            android:layout_weight=&quot;1&quot;</pre></td></tr><tr><td data-num="16"></td><td><pre>            android:layout_width=&quot;0dp&quot;</pre></td></tr><tr><td data-num="17"></td><td><pre>            android:layout_height=&quot;70dp&quot;</pre></td></tr><tr><td data-num="18"></td><td><pre>            android:orientation=&quot;vertical&quot;</pre></td></tr><tr><td data-num="19"></td><td><pre>            android:layout_marginRight=&quot;15dp&quot;</pre></td></tr><tr><td data-num="20"></td><td><pre>            android:layout_marginLeft=&quot;15dp&quot;&gt;</pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>        &lt;TextView</pre></td></tr><tr><td data-num="23"></td><td><pre>                android:id=&quot;@+id/name&quot;</pre></td></tr><tr><td data-num="24"></td><td><pre>                android:layout_width=&quot;match_parent&quot;</pre></td></tr><tr><td data-num="25"></td><td><pre>                android:layout_weight=&quot;1&quot;</pre></td></tr><tr><td data-num="26"></td><td><pre>                android:layout_height=&quot;match_parent&quot;</pre></td></tr><tr><td data-num="27"></td><td><pre>                android:text=&quot;@string/name&quot;</pre></td></tr><tr><td data-num="28"></td><td><pre>                android:textStyle=&quot;bold&quot;</pre></td></tr><tr><td data-num="29"></td><td><pre>                android:textColor=&quot;#000&quot;</pre></td></tr><tr><td data-num="30"></td><td><pre>                android:textSize=&quot;20sp&quot; tools:ignore=&quot;NestedWeights&quot;/&gt;</pre></td></tr><tr><td data-num="31"></td><td><pre>        &lt;TextView</pre></td></tr><tr><td data-num="32"></td><td><pre>                android:id=&quot;@+id/phone&quot;</pre></td></tr><tr><td data-num="33"></td><td><pre>                android:layout_weight=&quot;1&quot;</pre></td></tr><tr><td data-num="34"></td><td><pre>                android:layout_height=&quot;match_parent&quot;</pre></td></tr><tr><td data-num="35"></td><td><pre>                android:layout_width=&quot;match_parent&quot;</pre></td></tr><tr><td data-num="36"></td><td><pre>                android:text=&quot;@string/phone&quot;</pre></td></tr><tr><td data-num="37"></td><td><pre>                android:textStyle=&quot;bold&quot;</pre></td></tr><tr><td data-num="38"></td><td><pre>                android:textColor=&quot;#666&quot;</pre></td></tr><tr><td data-num="39"></td><td><pre>                android:textSize=&quot;20sp&quot; /&gt;</pre></td></tr><tr><td data-num="40"></td><td><pre>    &lt;/LinearLayout&gt;</pre></td></tr><tr><td data-num="41"></td><td><pre>    &lt;Button</pre></td></tr><tr><td data-num="42"></td><td><pre>            android:layout_width=&quot;70dp&quot;</pre></td></tr><tr><td data-num="43"></td><td><pre>            android:layout_height=&quot;70dp&quot;</pre></td></tr><tr><td data-num="44"></td><td><pre>            android:id=&quot;@+id/call&quot;</pre></td></tr><tr><td data-num="45"></td><td><pre>            android:text=&quot;@string/call&quot;</pre></td></tr><tr><td data-num="46"></td><td><pre>    /&gt;</pre></td></tr><tr><td data-num="47"></td><td><pre>&lt;/LinearLayout&gt;</pre></td></tr></table><div class="operation"><span class="breakline-btn"><i class="ic i-align-left"></i></span><span class="copy-btn"><i class="ic i-clipboard"></i></span><span class="fullscreen-btn"><i class="ic i-expand"></i></span></div></div></figure><p>3）编写Activity类，单击查询通讯录信息，申请运行时权限</p><p>MainActivity</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><div class="code-container"><table><tr><td data-num="1"></td><td><pre>package tk.dragondyt.study6;</pre></td></tr><tr><td data-num="2"></td><td><pre>import android.Manifest;</pre></td></tr><tr><td data-num="3"></td><td><pre>import android.content.pm.PackageManager;</pre></td></tr><tr><td data-num="4"></td><td><pre>import android.database.Cursor;</pre></td></tr><tr><td data-num="5"></td><td><pre>import android.os.Bundle;</pre></td></tr><tr><td data-num="6"></td><td><pre>import android.provider.ContactsContract;</pre></td></tr><tr><td data-num="7"></td><td><pre>import android.util.Log;</pre></td></tr><tr><td data-num="8"></td><td><pre>import android.widget.ListView;</pre></td></tr><tr><td data-num="9"></td><td><pre>import android.widget.Toast;</pre></td></tr><tr><td data-num="10"></td><td><pre>import androidx.annotation.NonNull;</pre></td></tr><tr><td data-num="11"></td><td><pre>import androidx.appcompat.app.AppCompatActivity;</pre></td></tr><tr><td data-num="12"></td><td><pre>import androidx.core.app.ActivityCompat;</pre></td></tr><tr><td data-num="13"></td><td><pre>import androidx.core.content.ContextCompat;</pre></td></tr><tr><td data-num="14"></td><td><pre>import java.util.ArrayList;</pre></td></tr><tr><td data-num="15"></td><td><pre>import java.util.List;</pre></td></tr><tr><td data-num="16"></td><td><pre>/**</pre></td></tr><tr><td data-num="17"></td><td><pre> * @author dyt</pre></td></tr><tr><td data-num="18"></td><td><pre> */</pre></td></tr><tr><td data-num="19"></td><td><pre>public class MainActivity extends AppCompatActivity {</pre></td></tr><tr><td data-num="20"></td><td><pre>    final String TAG = &quot;MainActivity&quot;;</pre></td></tr><tr><td data-num="21"></td><td><pre>    ContactPersonAdapter adapter;</pre></td></tr><tr><td data-num="22"></td><td><pre>    List&lt;Person&gt; contactsList = new ArrayList&lt;&gt;();</pre></td></tr><tr><td data-num="23"></td><td><pre>    @Override</pre></td></tr><tr><td data-num="24"></td><td><pre>    protected void onCreate(Bundle savedInstanceState) {</pre></td></tr><tr><td data-num="25"></td><td><pre>        super.onCreate(savedInstanceState);</pre></td></tr><tr><td data-num="26"></td><td><pre>        setContentView(R.layout.activity_main);</pre></td></tr><tr><td data-num="27"></td><td><pre>        ListView listView = findViewById(R.id.list);</pre></td></tr><tr><td data-num="28"></td><td><pre>        adapter = new ContactPersonAdapter(this,getLayoutInflater(),contactsList);</pre></td></tr><tr><td data-num="29"></td><td><pre>        if(ContextCompat.checkSelfPermission(this, Manifest.permission.READ_CONTACTS) != PackageManager.PERMISSION_GRANTED) {</pre></td></tr><tr><td data-num="30"></td><td><pre>            ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.READ_CONTACTS}, 1);</pre></td></tr><tr><td data-num="31"></td><td><pre>        } else {</pre></td></tr><tr><td data-num="32"></td><td><pre>            readContacts();</pre></td></tr><tr><td data-num="33"></td><td><pre>        }</pre></td></tr><tr><td data-num="34"></td><td><pre>        if(ContextCompat.checkSelfPermission(this, Manifest.permission.CALL_PHONE) != PackageManager.PERMISSION_GRANTED) {</pre></td></tr><tr><td data-num="35"></td><td><pre>            ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.CALL_PHONE}, 100);</pre></td></tr><tr><td data-num="36"></td><td><pre>        }</pre></td></tr><tr><td data-num="37"></td><td><pre>        listView.setAdapter(adapter);</pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre>    }</pre></td></tr><tr><td data-num="40"></td><td><pre>    private void readContacts() {</pre></td></tr><tr><td data-num="41"></td><td><pre>        try(Cursor cursor = getContentResolver().query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI,</pre></td></tr><tr><td data-num="42"></td><td><pre>                null, null, null, null)) {</pre></td></tr><tr><td data-num="43"></td><td><pre>            if (cursor != null) {</pre></td></tr><tr><td data-num="44"></td><td><pre>                while (cursor.moveToNext()) {</pre></td></tr><tr><td data-num="45"></td><td><pre>                    String name = cursor.getString(cursor.getColumnIndex(</pre></td></tr><tr><td data-num="46"></td><td><pre>                            ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME));</pre></td></tr><tr><td data-num="47"></td><td><pre>                    String phone = cursor.getString(cursor.getColumnIndex(</pre></td></tr><tr><td data-num="48"></td><td><pre>                            ContactsContract.CommonDataKinds.Phone.NUMBER));</pre></td></tr><tr><td data-num="49"></td><td><pre>                    contactsList.add(new Person(name,phone));</pre></td></tr><tr><td data-num="50"></td><td><pre>                }</pre></td></tr><tr><td data-num="51"></td><td><pre>                adapter.notifyDataSetChanged();</pre></td></tr><tr><td data-num="52"></td><td><pre>            }</pre></td></tr><tr><td data-num="53"></td><td><pre>        } catch (Exception e) {</pre></td></tr><tr><td data-num="54"></td><td><pre>            Log.d(TAG, &quot;readContacts: &quot;+e.getMessage());</pre></td></tr><tr><td data-num="55"></td><td><pre>        }</pre></td></tr><tr><td data-num="56"></td><td><pre>    }</pre></td></tr><tr><td data-num="57"></td><td><pre>    @Override</pre></td></tr><tr><td data-num="58"></td><td><pre>    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions,@NonNull int[] grantsResults) {</pre></td></tr><tr><td data-num="59"></td><td><pre>        if (requestCode == 1) {</pre></td></tr><tr><td data-num="60"></td><td><pre>            if (grantsResults.length &gt; 0 &amp;&amp; grantsResults[0] == PackageManager.PERMISSION_GRANTED) {</pre></td></tr><tr><td data-num="61"></td><td><pre>                readContacts();</pre></td></tr><tr><td data-num="62"></td><td><pre>            } else {</pre></td></tr><tr><td data-num="63"></td><td><pre>                Toast.makeText(this, &quot;请授予访问通讯录权限&quot;, Toast.LENGTH_SHORT).show();</pre></td></tr><tr><td data-num="64"></td><td><pre>            }</pre></td></tr><tr><td data-num="65"></td><td><pre>        }</pre></td></tr><tr><td data-num="66"></td><td><pre>        if (requestCode==100){</pre></td></tr><tr><td data-num="67"></td><td><pre>            if (grantsResults.length &gt; 0 &amp;&amp; grantsResults[0] == PackageManager.PERMISSION_GRANTED) {</pre></td></tr><tr><td data-num="68"></td><td><pre>                readContacts();</pre></td></tr><tr><td data-num="69"></td><td><pre>            } else {</pre></td></tr><tr><td data-num="70"></td><td><pre>                Toast.makeText(this, &quot;请授予拨打电话权限&quot;, Toast.LENGTH_SHORT).show();</pre></td></tr><tr><td data-num="71"></td><td><pre>            }</pre></td></tr><tr><td data-num="72"></td><td><pre>        }</pre></td></tr><tr><td data-num="73"></td><td><pre>    }</pre></td></tr><tr><td data-num="74"></td><td><pre>}</pre></td></tr><tr><td data-num="75"></td><td><pre></pre></td></tr></table><div class="operation"><span class="breakline-btn"><i class="ic i-align-left"></i></span><span class="copy-btn"><i class="ic i-clipboard"></i></span><span class="fullscreen-btn"><i class="ic i-expand"></i></span></div></div></figure><p>4）通过通讯录应用程序提供的内容提供器查询其数据</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><div class="code-container"><table><tr><td data-num="1"></td><td><pre>private void readContacts() {</pre></td></tr><tr><td data-num="2"></td><td><pre>        try(Cursor cursor = getContentResolver().query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI,</pre></td></tr><tr><td data-num="3"></td><td><pre>                null, null, null, null)) {</pre></td></tr><tr><td data-num="4"></td><td><pre>            if (cursor != null) {</pre></td></tr><tr><td data-num="5"></td><td><pre>                while (cursor.moveToNext()) {</pre></td></tr><tr><td data-num="6"></td><td><pre>                    String name = cursor.getString(cursor.getColumnIndex(</pre></td></tr><tr><td data-num="7"></td><td><pre>                            ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME));</pre></td></tr><tr><td data-num="8"></td><td><pre>                    String phone = cursor.getString(cursor.getColumnIndex(</pre></td></tr><tr><td data-num="9"></td><td><pre>                            ContactsContract.CommonDataKinds.Phone.NUMBER));</pre></td></tr><tr><td data-num="10"></td><td><pre>                    contactsList.add(new Person(name,phone));</pre></td></tr><tr><td data-num="11"></td><td><pre>                }</pre></td></tr><tr><td data-num="12"></td><td><pre>                adapter.notifyDataSetChanged();</pre></td></tr><tr><td data-num="13"></td><td><pre>            }</pre></td></tr><tr><td data-num="14"></td><td><pre>        } catch (Exception e) {</pre></td></tr><tr><td data-num="15"></td><td><pre>            Log.d(TAG, &quot;readContacts: &quot;+e.getMessage());</pre></td></tr><tr><td data-num="16"></td><td><pre>        }</pre></td></tr><tr><td data-num="17"></td><td><pre>    }</pre></td></tr></table><div class="operation"><span class="breakline-btn"><i class="ic i-align-left"></i></span><span class="copy-btn"><i class="ic i-clipboard"></i></span><span class="fullscreen-btn"><i class="ic i-expand"></i></span></div></div></figure><p>5）编写ListView展示通讯录方法，把查询到的数据展示在页面</p><p>ContactPersonAdapter</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><div class="code-container"><table><tr><td data-num="1"></td><td><pre>package tk.dragondyt.study6;</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>import android.annotation.SuppressLint;</pre></td></tr><tr><td data-num="4"></td><td><pre>import android.content.Context;</pre></td></tr><tr><td data-num="5"></td><td><pre>import android.content.Intent;</pre></td></tr><tr><td data-num="6"></td><td><pre>import android.net.Uri;</pre></td></tr><tr><td data-num="7"></td><td><pre>import android.view.LayoutInflater;</pre></td></tr><tr><td data-num="8"></td><td><pre>import android.view.View;</pre></td></tr><tr><td data-num="9"></td><td><pre>import android.view.ViewGroup;</pre></td></tr><tr><td data-num="10"></td><td><pre>import android.widget.BaseAdapter;</pre></td></tr><tr><td data-num="11"></td><td><pre>import android.widget.Button;</pre></td></tr><tr><td data-num="12"></td><td><pre>import android.widget.TextView;</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>import java.util.List;</pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>/**</pre></td></tr><tr><td data-num="17"></td><td><pre> * @author dyt</pre></td></tr><tr><td data-num="18"></td><td><pre> */</pre></td></tr><tr><td data-num="19"></td><td><pre>public class ContactPersonAdapter extends BaseAdapter {</pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>    /**定义数据*/</pre></td></tr><tr><td data-num="22"></td><td><pre>    private final List&lt;Person&gt; mData;</pre></td></tr><tr><td data-num="23"></td><td><pre>    /**定义Inflater,加载我们自定义的布局。*/</pre></td></tr><tr><td data-num="24"></td><td><pre>    private final LayoutInflater mInflater;</pre></td></tr><tr><td data-num="25"></td><td><pre>    private final Context context;</pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>  /**</pre></td></tr><tr><td data-num="28"></td><td><pre>    定义构造器，在Activity创建对象Adapter的时候将数据data和Inflater传入自定义的Adapter中进行处理。</pre></td></tr><tr><td data-num="29"></td><td><pre>    */</pre></td></tr><tr><td data-num="30"></td><td><pre>    public ContactPersonAdapter(Context context,LayoutInflater inflater, List&lt;Person&gt; data){</pre></td></tr><tr><td data-num="31"></td><td><pre>        mInflater = inflater;</pre></td></tr><tr><td data-num="32"></td><td><pre>        mData = data;</pre></td></tr><tr><td data-num="33"></td><td><pre>        this.context = context;</pre></td></tr><tr><td data-num="34"></td><td><pre>    }</pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre>    @Override</pre></td></tr><tr><td data-num="37"></td><td><pre>    public int getCount() {</pre></td></tr><tr><td data-num="38"></td><td><pre>        return mData.size();</pre></td></tr><tr><td data-num="39"></td><td><pre>    }</pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre>    @Override</pre></td></tr><tr><td data-num="42"></td><td><pre>    public Object getItem(int position) {</pre></td></tr><tr><td data-num="43"></td><td><pre>        return position;</pre></td></tr><tr><td data-num="44"></td><td><pre>    }</pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre>    @Override</pre></td></tr><tr><td data-num="47"></td><td><pre>    public long getItemId(int position) {</pre></td></tr><tr><td data-num="48"></td><td><pre>        return position;</pre></td></tr><tr><td data-num="49"></td><td><pre>    }</pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre>    @Override</pre></td></tr><tr><td data-num="52"></td><td><pre>    public View getView(int position, View view, ViewGroup viewGroup) {</pre></td></tr><tr><td data-num="53"></td><td><pre>        @SuppressLint(&quot;ViewHolder&quot;)</pre></td></tr><tr><td data-num="54"></td><td><pre>        View item = mInflater.inflate(R.layout.list_item,null);</pre></td></tr><tr><td data-num="55"></td><td><pre>        Person person = mData.get(position);</pre></td></tr><tr><td data-num="56"></td><td><pre>        TextView name = item.findViewById(R.id.name);</pre></td></tr><tr><td data-num="57"></td><td><pre>        TextView phone = item.findViewById(R.id.phone);</pre></td></tr><tr><td data-num="58"></td><td><pre>        Button call = item.findViewById(R.id.call);</pre></td></tr><tr><td data-num="59"></td><td><pre>        call.setOnClickListener((v)-&gt;{</pre></td></tr><tr><td data-num="60"></td><td><pre>            Intent intentCall =  new Intent();</pre></td></tr><tr><td data-num="61"></td><td><pre>            intentCall.setAction(Intent.ACTION_CALL);</pre></td></tr><tr><td data-num="62"></td><td><pre>            intentCall.setData(Uri.parse(&quot;tel:&quot; + person.getPhone()));</pre></td></tr><tr><td data-num="63"></td><td><pre>            context.startActivity(intentCall);</pre></td></tr><tr><td data-num="64"></td><td><pre>        });</pre></td></tr><tr><td data-num="65"></td><td><pre>        name.setText(person.name);</pre></td></tr><tr><td data-num="66"></td><td><pre>        phone.setText(person.phone);</pre></td></tr><tr><td data-num="67"></td><td><pre>         return item ;</pre></td></tr><tr><td data-num="68"></td><td><pre>    }</pre></td></tr><tr><td data-num="69"></td><td><pre>}</pre></td></tr></table><div class="operation"><span class="breakline-btn"><i class="ic i-align-left"></i></span><span class="copy-btn"><i class="ic i-clipboard"></i></span><span class="fullscreen-btn"><i class="ic i-expand"></i></span></div></div></figure><p>Person</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><div class="code-container"><table><tr><td data-num="1"></td><td><pre>package tk.dragondyt.study6;</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>/**</pre></td></tr><tr><td data-num="4"></td><td><pre> * @author dyt</pre></td></tr><tr><td data-num="5"></td><td><pre> */</pre></td></tr><tr><td data-num="6"></td><td><pre>public class Person {</pre></td></tr><tr><td data-num="7"></td><td><pre>    String name;</pre></td></tr><tr><td data-num="8"></td><td><pre>    String phone;</pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    public Person(String name, String phone) {</pre></td></tr><tr><td data-num="11"></td><td><pre>        this.name = name;</pre></td></tr><tr><td data-num="12"></td><td><pre>        this.phone = phone;</pre></td></tr><tr><td data-num="13"></td><td><pre>    }</pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>    public String getName() {</pre></td></tr><tr><td data-num="16"></td><td><pre>        return name;</pre></td></tr><tr><td data-num="17"></td><td><pre>    }</pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>    public void setName(String name) {</pre></td></tr><tr><td data-num="20"></td><td><pre>        this.name = name;</pre></td></tr><tr><td data-num="21"></td><td><pre>    }</pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>    public String getPhone() {</pre></td></tr><tr><td data-num="24"></td><td><pre>        return phone;</pre></td></tr><tr><td data-num="25"></td><td><pre>    }</pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>    public void setPhone(String phone) {</pre></td></tr><tr><td data-num="28"></td><td><pre>        this.phone = phone;</pre></td></tr><tr><td data-num="29"></td><td><pre>    }</pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre>    @Override</pre></td></tr><tr><td data-num="32"></td><td><pre>    public String toString() {</pre></td></tr><tr><td data-num="33"></td><td><pre>        return &quot;Person{&quot; +</pre></td></tr><tr><td data-num="34"></td><td><pre>                &quot;name=&#39;&quot; + name + &#39;\\&#39;&#39; +</pre></td></tr><tr><td data-num="35"></td><td><pre>                &quot;, phone=&#39;&quot; + phone + &#39;\\&#39;&#39; +</pre></td></tr><tr><td data-num="36"></td><td><pre>                &#39;}&#39;;</pre></td></tr><tr><td data-num="37"></td><td><pre>    }</pre></td></tr><tr><td data-num="38"></td><td><pre>}</pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr></table><div class="operation"><span class="breakline-btn"><i class="ic i-align-left"></i></span><span class="copy-btn"><i class="ic i-clipboard"></i></span><span class="fullscreen-btn"><i class="ic i-expand"></i></span></div></div></figure><h4 id="最后附上截图-最讨厌没图的教程。" tabindex="-1"><a class="header-anchor" href="#最后附上截图-最讨厌没图的教程。" aria-hidden="true">#</a> 最后附上截图，最讨厌没图的教程。</h4><p><img src="https://i.loli.net/2020/05/10/4ZVY3qmebrPkGuM.png" alt="运行截图"></p><p><a href="https://vip.d0.baidupan.com/file/?VTMBP1loBTQBCFBoUGVRPQE+ATlTfwt9CnhQMlJ3W2wBLwUoCj4GIlMjADBWa1c6AD8FX1FnAmRWbAE1Uz0BNlVhAW5ZNQVmAWZQIFBiUSMBZgEzUzoLOQo/UGdSPltsAScFIgonBm9TNwBmVjBXZgB1BTBROwIvVmABN1MgATVVbQFnWTMFNwFiUGJQYlFjAW4BYFM+Cz4KOVBkUjtbPAFnBWQKYwZiU2YAZ1ZgV2UAPAU2UTYCZlZpATdTPAEuVS8BP1l0BXcBIlB1UGFRIgEyAWBTMQs4CjlQZFI6W2IBMQViCnEGJlNsADtWZ1cwAGcFMVE7AjhWaAE2Uz8BMVVkAWFZMQV/AXFQc1B0UW0BagEqUyoLbwphUCFSM1tqAScFJwonBiVTOABnVjdXbgBjBTFRPgIwVmABNFM7ASZVIAE/WXQFbAFmUDFQMVF+AW8BKlM+CzgKO1B4Ujo=" target="_blank" rel="noopener noreferrer">实验源码</a></p>',35),p=[n];function i(o,u){return d(),r("div",null,p)}const m=t(e,[["render",i],["__file","c4877271.html.vue"]]);export{m as default};
